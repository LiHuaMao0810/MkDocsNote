
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://lihuamao0810.github.io/MkDocsNote/DiffusionModel/FlowMatching/">
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../ConsistencyModel/">
      
      
        
      
      
      <link rel="icon" href="../../assets/logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>[CFM Overviw] Flow Matching 流匹配 - LiHuaMao 的小站</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="deep-purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cfm-overviw-flow-matching" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="LiHuaMao 的小站" class="md-header__button md-logo" aria-label="LiHuaMao 的小站" data-md-component="logo">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LiHuaMao 的小站
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              [CFM Overviw] Flow Matching 流匹配
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="deep-purple"  aria-label="Dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="deep-orange"  aria-label="Light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  
    
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../blog/" class="md-tabs__link">
          
  
  
    
  
  Blog

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  Diffusion Model

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../experience/" class="md-tabs__link">
          
  
  
    
  
  经验贴整理

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../PostTraining/RLHF/" class="md-tabs__link">
          
  
  
    
  
  模型后训练

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../UML/" class="md-tabs__link">
          
  
  
    
  
  课程笔记

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../about/" class="md-tabs__link">
        
  
  
    
  
  关于我

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="LiHuaMao 的小站" class="md-nav__button md-logo" aria-label="LiHuaMao 的小站" data-md-component="logo">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    LiHuaMao 的小站
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../.." class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Home
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tags/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    标签
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../blog/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Blog
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Blog
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    归档
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    归档
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../blog/archive/2026/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2026
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Diffusion Model
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Diffusion Model
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    [CFM Overviw] Flow Matching 流匹配
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    [CFM Overviw] Flow Matching 流匹配
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      
        1 目标
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-quick-start" class="md-nav__link">
    <span class="md-ellipsis">
      
        2 Quick Start
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2 Quick Start">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1 设计概率路径
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2 计算损失
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      
        3 一般条件和边缘化技巧
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3 一般条件和边缘化技巧">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1 边缘速度场
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2 证明边缘路径
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ConsistencyModel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Consistency Model 一致性模型
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RectifiedFlow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Rectified Flow 修正流
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DistributionMatching/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Distribution Matching Distillation 分布匹配蒸馏
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../UnderstandingDiffusionModels/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Understanding Diffusion Models: A Unified Perspective
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Diff-Instruct/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Diff-Instruct Distillation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DreamDiffusion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ProlificDream &amp; DreamDiffusion
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../MeanFlow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mean Flow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SelfDistillation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Learnig Flow Map via Self Distillation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../experience/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    经验贴整理
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    经验贴整理
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../experience/algorithm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    算法岗面经
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../experience/cc98/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    校内资源贴整理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../experience/softwareEngineer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    工程经验
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../experience/resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    推荐学习资源
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../experience/others/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    其他
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    模型后训练
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    模型后训练
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../PostTraining/RLHF/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Reforcement Learning from Human Feedback
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    课程笔记
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    课程笔记
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../UML/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    UML建模
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    UML建模
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UML/UseCaseDiagram/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    UML 用例图
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UML/SequenceDiagram/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    UML 序列图
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../UML/CommunicationDiagram/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    UML 通信图（协作图）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    计算机系统原理
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    计算机系统原理
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ComputerOrganization/chapter1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 1
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ComputerOrganization/chapter2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter2 计算机的算数运算
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ComputerOrganization/chapter3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 3 RISC-V
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ComputerOrganization/chapter4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    chapter4 处理器
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ComputerOrganization/chapter5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter5 Cache/Memory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../SoftwareTest/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    软件测试与质量保证
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    软件测试与质量保证
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../SoftwareTest/TestPlan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    测试计划
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../SoftwareTest/TestCase/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    测试用例
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../SoftwareTest/TestExcute/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    测试执行
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    关于我
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      
        1 目标
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-quick-start" class="md-nav__link">
    <span class="md-ellipsis">
      
        2 Quick Start
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2 Quick Start">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1 设计概率路径
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2 计算损失
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      
        3 一般条件和边缘化技巧
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3 一般条件和边缘化技巧">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1 边缘速度场
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2 证明边缘路径
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  

  <nav class="md-tags" >
    
      
      
      
      
        <a href="../../tags/#tag:条件流匹配" class="md-tag">条件流匹配</a>
      
    
      
      
      
      
        <a href="../../tags/#tag:流匹配" class="md-tag">流匹配</a>
      
    
  </nav>



<h1 id="cfm-overviw-flow-matching">[CFM Overviw] Flow Matching 流匹配</h1>
<div class="admonition info">
<p class="admonition-title">文档信息</p>
<p>创建时间：2025-11-26 | 更新时间：2025-12-3</p>
<p>本文基于<strong><a href="https://arxiv.org/abs/2412.06264">Flow Matching Guide and Code</a></strong> 做笔记</p>
</div>
<div class="admonition note">
<p class="admonition-title">AI的睡前小故事</p>
<p>在一个遥远的数字王国里，住着一位名叫小明的年轻魔法师。他的梦想是能够创造出全新的、独一无二的魔法生物。然而，要实现这个梦想并不容易，因为每个魔法生物都需要遵循一种神秘的目标分布，这种分布决定了生物的特征和属性。</p>
<p>小明知道，要创造出符合目标分布的魔法生物，他需要找到一条从源分布（一种简单而熟悉的分布，比如高斯分布）到目标分布的概率路径。这条路径就像是一张魔法地图，指引着他从已知的魔法世界走向未知的奇幻领域。</p>
<p>为了绘制这张魔法地图，小明需要学习一种叫做流匹配（Flow Matching）的古老魔法。这种魔法的核心是构建一个速度场 ut​，它就像是一股无形的风，推动着魔法生物沿着概率路径演化。速度场由一个叫做流 ψt​(x) 的魔法公式定义，这个公式描述了魔法生物在每个时间点的状态。</p>
<p>然而，要让这个魔法生效，小明必须遵守两个重要的边界条件：</p>
<div class="language-text highlight"><pre><span></span><code>起点的坚守：在时间 t=0 时，魔法生物必须保持其在源分布中的原始状态，即 ψ0​(X0​)=X0​。
终点的追寻：在时间 t=1 时，魔法生物必须演化成符合目标分布的新形态，即 ψ1​(X0​)∼q。
</code></pre></div>
<p>为了确保魔法生物能够沿着正确的路径演化，小明需要使用一种叫做微分方程（ODE）的魔法工具。这个工具告诉他，速度场 ut​ 就是流 ψt​(x) 的导数，它决定了魔法生物在每个时间点上的变化方向和速度。</p>
<p>小明明白，为什么要先构建一个概率路径，而不是让速度场直接决定概率路径。因为先设计好概率路径，可以确保魔法生物在起点和终点都符合要求，就像是给魔法之旅设定了明确的起点和终点，让旅程更加顺利和安全。</p>
<p>终于，小明掌握了流匹配的魔法，他开始从源分布中采样魔法生物的初始状态 X0​，然后让它们沿着概率路径演化。在时间 t=1 时，他惊喜地发现，这些魔法生物已经变成了全新的、独一无二的形态，完全符合他的目标分布。</p>
</div>
<h2 id="1">1 目标</h2>
<p>​   从<strong>目标分布</strong> <span class="arithmatex">\(q\)</span> 采样一些样本，我们的目标是生成属于目标分布的新样本。</p>
<p>​   为了解决这个问题，流匹配的思想是，构建一条<strong>概率路径</strong> <span class="arithmatex">\(p_t\)</span> ，实际上是任意t时刻的数据分布，从<strong>源分布</strong> <span class="arithmatex">\(p_0\)</span>转换到目标分布<span class="arithmatex">\(p_1 = q\)</span> 。</p>
<p>​   具体的说，FM（flow matching）的目标是用神经网络拟合<strong>速度场</strong> <span class="arithmatex">\(u_t\)</span>，用于唯一确定一个<strong>流</strong> <span class="arithmatex">\(\psi_t(x)\)</span>。如果从源分布任意采样一个 <span class="arithmatex">\(X_0\)</span> 都满足
$$
X_t = \psi_t(X0) \sim p_t
$$
 也就是可以得到t时刻这个样本的演化结果，并且符合我们概率路径的分布，我们就说这个<strong>速度场 <span class="arithmatex">\(u_t\)</span> 确实生成了对应的概率路径 <span class="arithmatex">\(p_t\)</span></strong> </p>
<p>同时，流还应该满足边界条件
$$
\psi_0(X_0) = X_0  \
\psi_1(X_0) \sim q
$$
​   其中 <span class="arithmatex">\(u_t\)</span> 和 <span class="arithmatex">\(\psi_t(x)\)</span>的关系由微分方程ODE定义：
$$
\frac{d}{dt} \psi_t(x) = u_t(\psi_t(x))
$$
​   不难发现速度场就是流的导数，方向，或者说演化的速度。</p>
<p>​   </p>
<details class="note">
<summary>图片和分布如何联系？</summary>
<p>把一张图片看作高维空间中的一个数据点，整个数据集看作高维空间的概率分布。</p>
</details>
<details class="note">
<summary>什么是源分布？</summary>
<p>是我们已知的分布，通常比较简单，比如高斯分布，因为他便于采样而且可能有良好的性质。也可能是和目标分布有关的分布，比如如果我们希望模型补全图片，或者对图片局部进行修改，那么源分布就是需要修改的图片。</p>
</details>
<details class="note">
<summary>什么是概率路径？</summary>
<p>通常我们约定这个转换的过程起始时间步为0，终点为1。概率路径 <span class="arithmatex">\(p_t(0\le t \le 1)\)</span> 可以看作一个关于t的函数，给定一个时间t，可以给出t时刻的数据分布。</p>
</details>
<details class="note">
<summary>为什么要先构建一个概率路径，让速度场拟合概率路径，而不是让速度场直接决定概率路径？</summary>
<p>我觉得是先设计概率路径可以确保满足边界条件，保证结果正确。让速度场决定概率路径需要很多约束条件，非常难实现。</p>
</details>
<h2 id="2-quick-start">2 Quick Start</h2>
<p>​   <img alt="image-20250921123658977" src="../assets/image-20250921123658977.png" /></p>
<ol>
<li>
<p>目标是找到一个流映射，将样本 <span class="arithmatex">\(X_0\)</span> 从已知的源或噪声分布 <em>q</em> 映射到来自未知的目标或数据分布<em>q</em> 的样本 <span class="arithmatex">\(X_1\)</span>。 </p>
</li>
<li>
<p>为此，设计一个时间连续概率路径 <span class="arithmatex">\(p_t(0\le t \le 1)\)</span>，在 <span class="arithmatex">\(p := p_0 和 q := p_1\)</span> 之间插值。 </p>
</li>
<li>
<p>在训练期间，使用回归来估计生成 <span class="arithmatex">\(p_t\)</span> 的速度场 <span class="arithmatex">\(u_t\)</span>。 </p>
</li>
<li>
<p>要采样一个新的目标分布样本，可以从初始分布取样本<span class="arithmatex">\(X _0\)</span> ，通过从速度场的积分，也就是流映射，得到对应的目标样本<span class="arithmatex">\(X _1\)</span></p>
</li>
</ol>
<h3 id="21">2.1 设计概率路径</h3>
<p>理解流匹配的蓝图之后，首先进行上述的第一步：设计一条概率路径。</p>
<p>我们设计概率路径的思想是，如果你知道目的地，那你直线走过去就行。所以对于每一个目标样本，我们可以得到一个后验的路径，也可以称之为条件路径。即给定目标样本x，逆推什么路径能通往目标样本。通过多次采样，然后将这些条件路径聚合，我们就得到了从源分布到目标分布的一个概率路径。这样设计的概率路径我们称之为<strong>条件最优传输</strong>或者<strong>线性路径</strong>，这也很好理解，因为我们的条件路径就是从源样本到目标样本的最优路径。这样的概率路径满足以下的公式：
$$
p_t(x) = \int p_{t|1}(x|x_1) q(x_1) \, dx_1, \quad \text{where } p_{t|1}(x|x_1) = \mathcal{N}(x | tx_1, (1-t)^2 I).
$$
使用这样的条件路径，我们可以通过采样源分布和目标分布，将他们线性组合得到随机变量
$$
X_t = t X_1 + (1-t) X_0 \sim p_t.
$$
​   </p>
<h3 id="22">2.2 计算损失</h3>
<p>设计概率路径之后，继续进行第二步：用神经网络生成的速度场 <span class="arithmatex">\(u_{t}^{\theta}\)</span> 来拟合概率路径的速度场，用简单的MSE损失很容易得到损失函数： </p>
<div class="arithmatex">\[
\begin{aligned}
\mathcal{L}_{\text{FM}}(\theta) &amp;= \mathbb{E}_{t, X_t} \left\| u_t^\theta(X_t) - u_t(X_t) \right\|^2, \\
&amp;\quad \text{where } t \sim \mathcal{U}[0, 1] \text{ and } X_t \sim p_t.
\end{aligned}
\]</div>
<p>但是在实践中，使用这个公式依然有一些问题，就是目标速度场 <span class="arithmatex">\(u _t\)</span> 依然是一个非常复杂的对象，控制着两个高维分布的联合转换。幸好在我们设计的线性路径中，可以通过在单个目标上，对损失进行条件化，因为条件变量满足：
$$
X_{t|1} = t x_1 + (1-t) X_0 \quad \sim \quad p_{t|1}(\cdot | x_1) = \mathcal{N}(\cdot | t x_1, (1-t)^2 I).
$$
所以可以得到条件速度，即从当前状态直线指向目标样本的速度：
$$
u_t(x | x_1) = \frac{x_1 - x}{1 - t},
$$
从而得到条件概率路径 <span class="arithmatex">\(p_{t|1}(\cdot | x_1)\)</span></p>
<p>因此我们就得到了刚才损失函数的可计算版本：</p>
<div class="arithmatex">\[
\begin{aligned}
\mathcal{L}_{\text{CFM}}(\theta) &amp;= \mathbb{E}_{t, X_t, X_1} \left\| u_t^\theta(X_t) - u_t(X_t | X_1) \right\|^2 \\
&amp;\quad \text{where } t \sim U[0, 1], \, X_0 \sim p, \, X_1 \sim q
\end{aligned}
\]</div>
<p>将速度带入,就得到了最简单的流匹配实现：</p>
<div class="arithmatex">\[
\begin{aligned}
\mathcal{L}_{\text{CFM}}^{\text{OT, Gauss}}(\theta) &amp;= \mathbb{E}_{t, X_0, X_1} \left\| u_t^\theta(X_t) - (X_1 - X_0) \right\|^2 \\
&amp;\quad \text{where } t \sim U[0, 1], \, X_0 \sim \mathcal{N}(0, I), \, X_1 \sim q
\end{aligned}
\]</div>
<p>值得注意的是，这两个损失函数提供的学习梯度是一样的，后面的章节有证明（可能）</p>
<p><img alt="image-20251126112807979" src="../assets/image-20251126112807979.png" /></p>
<h2 id="3">3 一般条件和边缘化技巧</h2>
<div class="admonition info">
<p class="admonition-title">省略的部分</p>
<p>quick start 中给出了一个利用条件路径来实现流匹配训练的方法，但是忽略了很多细节，更趋向于一种直觉的实现，留下了很多问题。比如：</p>
<ul>
<li>
<p>为什么能在单个目标上进行速度和路径的条件化？</p>
</li>
<li>
<p>这样条件化的结果能得到我们想要的边缘速度场和边缘路径吗？（这里的边缘对应概率论中的边缘概率，指聚合结果）</p>
</li>
</ul>
</div>
<h3 id="31">3.1 边缘速度场</h3>
<p>回忆我们刚刚提出的条件速度场，条件速度场能生成对应的条件概率路径：
$$
u_t(\cdot | x_1) \text{ generates } p_{t|1}(\cdot | x_1).
$$
我们可以构造一个聚合条件速度场的方式，即在目标样本上对条件速度场进行平均，给出边缘速度场：
$$
u_t(x) = \int u_t(x | x_1) p_{1|t}(x_1 | x) \, dx_1.
$$
这个公式的意思是：在已知当前状态x的情况下，给出目标样本分布的后验概率，然后对每个目标样本计算条件概率路径，将后验概率作为权重进行聚合。（总感觉有点VAE的样子？先把当前状态编码到目标样本的分布，再解码回来）</p>
<p>也可以将边缘概率写作条件期望，给定当前状态x的情况下，随机变量 <span class="arithmatex">\(u_t(X_T|X_1)\)</span> 的期望，也就是给定条件变量<span class="arithmatex">\(X_T\)</span>情况下，后验计算目标样本 <span class="arithmatex">\(X_1\)</span>的分布，然后 <span class="arithmatex">\(u_t\)</span>其实是以来于这两者的联合分布的随机变量：
$$
u_t(x) = \mathbb{E} \left[ u_t(X_t | X_1) \mid X_t = x \right],
$$</p>
<h3 id="32">3.2 证明边缘路径</h3>
<p>这里首先要给出一个引理：速度场 <span class="arithmatex">\(u_t\)</span> 能生成对应的概率路径 <span class="arithmatex">\(p_t\)</span> 等价于满足连续性方程（证明可以查看<a href="https://openreview.net/forum?id=PqvMRDCJT9t">Flow Matching For General Modeling</a>）：
$$
\frac{d}{dt} p_t(x) + \text{div}(p_t u_t)(x) = 0,
$$
在已知条件速度场能生成条件路径的情况下，给出证明：</p>
<p><img alt="image-20251127170202673" src="../assets/image-20251127170202673.png" /></p>
<p>（i）由交换积分和微分顺序得到</p>
<p>（ii）由条件概率和条件速度场满足连续性方程得到</p>
<p>（iii）是
$$
\frac{p_{t|Z}(x | z) p_Z(z)}{p_t(x)} = p(z|x)
$$
积分再乘 <span class="arithmatex">\(p_t(x)\)</span>得到</p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.indexes", "navigation.tabs", "navigation.sections", "navigation.top", "content.code.annotate", "content.code.copy"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"></script>
      
        <script src="../../javascripts/katex.js"></script>
      
    
  </body>
</html>